{% extends "index.html" %}
{% block content %}

<form method="post">
	<table>
		<tr>
			<th>Transfer Settings - from the Pi</th>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Upload Method:</div>
				<div class="alignright">
					<select name="tfrMethod" id="tfrMethod">
					{% for method in ['sftp','fileshare', 'manual'] %}
						<option value="{{ method }}"{% if method == tfrMethod %} SELECTED{% endif %}>{{ method }}</option>"
					{% endfor %}
					</select>
				</div>
			</td>
		</tr>
	</table>


	<table id="sftp">
		<tr>
			<td>
				<div class="alignleft">SFTP Server URL:</div>
				{% if sftpServer == '' %}
					<div class="alignright"><input type="text" name="sftpServer" value="ftp.somewhere.com"></div>
				{% else %}
					<div class="alignright"><input type="text" name="sftpServer" value="{{ sftpServer }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Username:</div>
				{% if sftpUser == '' %}
					<div class="alignright"><input type="text" name="sftpUser" value="ftp_user"></div>
				{% else %}
					<div class="alignright"><input type="text" name="sftpUser" value="{{ sftpUser }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Password:</div>
				{% if sftpPassword == '' %}
					<div class="alignright"><input type="password" name="sftpPassword" value=""></div>
				{% else %}
					<div class="alignright"><input type="password" name="sftpPassword" value="{{ sftpPassword }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Transfer day:</div>
				<div class="alignright">
					<select name="sftpDay">
					{% for day in ['Daily','Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
						<option value="{{ day }}"{% if day == sftpDay %} SELECTED{% endif %}>{{ day }}</option>
					{% endfor %}
					</select>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Transfer hour:</div>
				<div class="alignright">
					<select name="sftpHour" >
						{% for hour in ['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23'] %}
							<option value="{{ hour }}"{% if hour == sftpHour %} SELECTED{% endif %}>{{ hour }}</option>
						{% endfor %}
					</select>
				</div>
			</td>
		</tr>
	</table>

	<table id="file">
		<tr>
			<td>
				<div class="alignleft">File share path:</div>
				{% if fileServer == '' %}
					<div class="alignright"><input type="text" name="fileServer" value="\\server\folder\"></div>
				{% else %}
					<div class="alignright"><input type="text" name="fileServer" value="{{ fileServer }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Username:</div>
				{% if fileUser == '' %}
					<div class="alignright"><input type="text" name="fileUser" value="folder_user"></div>
				{% else %}
					<div class="alignright"><input type="text" name="fileUser" value="{{ fileUser }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Password:</div>
				{% if filePassword == '' %}
					<div class="alignright"><input type="password" name="filePassword" value=""></div>
				{% else %}
					<div class="alignright"><input type="password" name="filePassword" value="{{ filePassword }}"></div>
				{% endif %}	
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Transfer day:</div>
				<div class="alignright">
					<select name="fileDay">
					{% for day in ['Daily', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
						<option value="{{ day }}"{% if day == fileDay %} SELECTED{% endif %}>{{ day }}</option>
					{% endfor %}
					</select>
				</div>
			</td>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Transfer hour:</div>
				<div class="alignright">
					<select name="fileHour" >
						{% for hour in ['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23'] %}
							<option value="{{ hour }}"{% if hour == fileHour %} SELECTED{% endif %}>{{ hour }}</option>
						{% endfor %}
					</select>
				</div>
			</td>
		</tr>
	</table>

	<table>
		<tr>
			<th>Copy Settings - camera to Pi</th>
		</tr>
		<tr>
			<td>
				<div class="alignleft">Copy day:</div>
				<div class="alignright">
					<select name="copyDay" id="copyDay">
					{% for day in ['Off', 'Daily', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
						<option value="{{ day }}"{% if day == copyDay %} SELECTED{% endif %}>{{ day }}</option>
					{% endfor %}
					</select>
				</div>
			</td>
		</tr>
		<tr id="showhideCopyHour">
			<td>
				<div class="alignleft">Copy hour:</div>
				<div class="alignright">
					<select name="copyHour" >
						{% for hour in ['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23'] %}
							<option value="{{ hour }}"{% if hour == copyHour %} SELECTED{% endif %}>{{ hour }}</option>
						{% endfor %}
					</select>
				</div>
			</td>
		</tr>
	</table>
	
	<table class="noborder">
		<tr>
			<td class="noborder">
				<div class="alignleft">
					<button type="button" name="copy" id="copy">Copy Now</button>
				</div>
				<div class="alignright">
					<button type="submit" name="TfrApply">Apply</button>
				</div>
			</td>
		</tr>
	</table>
</form>

<!-- Hidden form for the Copy Now button, as you can't nest forms -->
<form style="display: none">
	<button type="submit" name="copyNow" id="copyNow" value="1">Copy Now</button>
</form>

<script>
	var method = document.getElementById("tfrMethod");
	var sftp = document.getElementById("sftp");
	var file = document.getElementById("file");
	sftp.style.display = (method.value != "sftp") ? "none":"";
	file.style.display = (method.value != "fileshare") ? "none":"";

	method.onchange = function(){
		sftp.style.display = (method.value != "sftp") ? "none":"";
		file.style.display = (method.value != "fileshare") ? "none":"";
	};

	var copyDay = document.getElementById("copyDay");
	var copyHour = document.getElementById("showhideCopyHour");
	copyHour.style.display = (copyDay.value == "Off") ? "none":"";
	copyDay.onchange = function(){
		copyHour.style.display = (this.value == "Off") ? "none":"";
	};
	
	var copyNow = document.getElementById("copy");
	copyNow.onclick = function(){
		document.getElementById("copyNow").click();
	}
</script>
{% endblock %}
